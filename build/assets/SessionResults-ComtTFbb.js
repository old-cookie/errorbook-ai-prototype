import{c as k,r as h,j as e,H as w}from"./index-BfPEUJob.js";import{B as g}from"./Button-Cjd3NleT.js";import{E}from"./EriCharacterSvg-BWiiiQiv.js";import{a as M,e as f,g as F,b as S}from"./appState-CC8KP1bt.js";import{m as a}from"./proxy-BIvXrzeu.js";import{Z as P}from"./zap-5y6cSMNz.js";import{S as B}from"./star-PIZw8ph9.js";import{A as $}from"./index-DG3CJH_J.js";/**
 * @license lucide-react v0.487.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const L=[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}]],T=k("rotate-ccw",L);function q({index:s,total:n}){const t=s/n*Math.PI*2,r=60+Math.random()*50,i=["#6C5CE7","#FBBF24","#34D399","#F472B6","#60A5FA","#F97316"],c=i[s%i.length],o=4+Math.random()*6,l=s%3===0;return e.jsx(a.div,{initial:{x:0,y:0,opacity:1,scale:0,rotate:0},animate:{x:Math.cos(t)*r,y:Math.sin(t)*r-20,opacity:[1,1,0],scale:[0,1.2,.6],rotate:Math.random()*360},transition:{duration:1.4+Math.random()*.8,delay:.3+s*.03,ease:"easeOut"},className:"absolute",style:{width:l?o:o*1.6,height:o,backgroundColor:c,borderRadius:l?"50%":2,top:"50%",left:"50%"}})}function A({value:s,delay:n}){return e.jsxs(a.span,{initial:{opacity:0,y:10,scale:.5},animate:{opacity:[0,1,1,0],y:[10,-8,-16,-30],scale:[.5,1.1,1,.8]},transition:{duration:1.2,delay:n,ease:"easeOut"},className:"absolute -top-6 text-sm font-bold text-[#6C5CE7]",children:["+",s]})}function W({isPerfect:s,reduceMotion:n}){return e.jsxs("div",{className:"relative flex items-center justify-center",children:[e.jsx(a.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},transition:{duration:.6},className:`absolute w-32 h-32 rounded-full ${s?"bg-gradient-to-br from-yellow-200/40 to-amber-200/40":"bg-gradient-to-br from-[#6C5CE7]/15 to-[#8B7FE8]/15"}`}),e.jsxs(a.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:12,stiffness:200,delay:.15},className:"relative",children:[e.jsx(E,{state:s?"correct":"idle",reduceMotion:n,size:112,className:"drop-shadow-lg"}),!s&&e.jsx(e.Fragment,{children:[0,1,2].map(t=>e.jsx(a.div,{initial:{scale:0},animate:{scale:[0,1,.8]},transition:{delay:.6+t*.15,type:"spring"},className:"absolute",style:{top:t===0?-6:t===1?-2:8,[t===2?"left":"right"]:t===0?-4:t===1?-8:-6},children:e.jsx(B,{size:t===0?14:11,className:"text-[#6C5CE7] fill-[#6C5CE7]/40"})},t))})]}),s&&e.jsx("div",{className:"absolute inset-0 flex items-center justify-center pointer-events-none",children:Array.from({length:24}).map((t,r)=>e.jsx(q,{index:r,total:24},r))})]})}function z({xpEarned:s,currentXP:n,levelXP:t}){const[r,i]=h.useState(!1),[c,o]=h.useState(!1),l=(n-s)/t*100,d=n/t*100;return h.useEffect(()=>{const p=setTimeout(()=>i(!0),800),m=setTimeout(()=>o(!0),1200);return()=>{clearTimeout(p),clearTimeout(m)}},[]),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-xs",children:[e.jsx("span",{className:"text-gray-500 font-medium",children:"Level 4"}),e.jsxs("div",{className:"relative",children:[e.jsxs("span",{className:"text-gray-500 font-medium",children:[n," / ",t," XP"]}),e.jsx($,{children:r&&e.jsx(A,{value:s,delay:0})})]})]}),e.jsx("div",{className:"h-3 bg-gray-100 rounded-full overflow-hidden border border-gray-200/60",children:e.jsx(a.div,{initial:{width:`${l}%`},animate:{width:c?`${d}%`:`${l}%`},transition:{duration:1,ease:[.34,1.56,.64,1]},className:"h-full rounded-full relative",style:{background:"linear-gradient(90deg, #6C5CE7 0%, #8B7FE8 60%, #A78BFA 100%)"},children:e.jsx(a.div,{initial:{x:"-100%"},animate:{x:"200%"},transition:{duration:1.5,delay:1.4,repeat:2,ease:"easeInOut"},className:"absolute inset-0 bg-gradient-to-r from-transparent via-white/30 to-transparent"})})})]})}function X({score:s,total:n}){const t=Math.round(s/n*100),r=2*Math.PI*36,i=r-t/100*r;return e.jsxs(a.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",damping:14,delay:.6},className:"flex items-center gap-5",children:[e.jsxs("div",{className:"relative w-20 h-20",children:[e.jsxs("svg",{width:"80",height:"80",viewBox:"0 0 80 80",children:[e.jsx("circle",{cx:"40",cy:"40",r:"36",fill:"none",stroke:"#F3F4F6",strokeWidth:"6"}),e.jsx(a.circle,{cx:"40",cy:"40",r:"36",fill:"none",stroke:t===100?"#FBBF24":"#6C5CE7",strokeWidth:"6",strokeLinecap:"round",strokeDasharray:r,initial:{strokeDashoffset:r},animate:{strokeDashoffset:i},transition:{duration:1.2,delay:.8,ease:[.34,1.56,.64,1]},transform:"rotate(-90 40 40)"})]}),e.jsx("div",{className:"absolute inset-0 flex flex-col items-center justify-center",children:e.jsxs(a.span,{initial:{opacity:0},animate:{opacity:1},transition:{delay:1},className:"text-xl font-bold text-gray-900",children:[s,"/",n]})})]}),e.jsxs("div",{className:"flex-1",children:[e.jsx(a.p,{initial:{opacity:0,x:12},animate:{opacity:1,x:0},transition:{delay:.9},className:"text-gray-900 font-bold text-lg",children:t===100?"Perfect Score!":`${t}% Correct`}),e.jsx(a.p,{initial:{opacity:0,x:12},animate:{opacity:1,x:0},transition:{delay:1},className:"text-gray-500 text-sm mt-0.5",children:t===100?"You nailed every question!":`${s} correct, ${n-s} to review`})]})]})}function D({index:s,question:n,correct:t,delay:r}){return e.jsxs(a.div,{initial:{opacity:0,x:-12},animate:{opacity:1,x:0},transition:{delay:r},className:"flex items-center gap-3 py-2.5",children:[e.jsx("div",{className:`w-7 h-7 rounded-full flex items-center justify-center flex-shrink-0 ${t?"bg-green-100 text-green-600":"bg-red-100 text-red-500"}`,children:t?e.jsx("svg",{width:"14",height:"14",viewBox:"0 0 14 14",fill:"none",children:e.jsx("path",{d:"M3 7.5L5.5 10L11 4",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"})}):e.jsx("svg",{width:"12",height:"12",viewBox:"0 0 12 12",fill:"none",children:e.jsx("path",{d:"M3 3L9 9M9 3L3 9",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round"})})}),e.jsxs("span",{className:"text-sm text-gray-700 flex-1",children:["Q",s+1,": ",n]})]})}function V({onNavigate:s,onEriClick:n,score:t=2,total:r=3,summary:i}){const c=i?.missionMode==="english",o=i?.score??t,l=i?.total??(c?3:r),d=o===l,[p]=h.useState(()=>M()),[m,y]=h.useState(f(o,l)),[j,v]=h.useState(()=>F().totalXP),b=400,N=c?"English Mission – Write, Speak, Listening":"Fractions – Adding Unlike Denominators";h.useEffect(()=>{if(!i)return;const x=S(i);y(x.rewards.xpEarned||f(o,l)),v(x.progress.totalXP)},[i,o,l]);const C=(c?[{question:`Write task (${i?.english?.writeChars??0} chars)`,correct:(i?.english?.writeChars??0)>=12},{question:`Speak task (${i?.english?.speakTurns??0} turn${(i?.english?.speakTurns??0)===1?"":"s"})`,correct:(i?.english?.speakTurns??0)>0},{question:`Listening task (${i?.english?.listeningTurns??0} turn${(i?.english?.listeningTurns??0)===1?"":"s"})`,correct:(i?.english?.listeningTurns??0)>0}]:[{question:"Calculate 1/2 + 1/3",correct:!0},{question:"Solve: 3x − 7 = 11",correct:!1},{question:"What is 20% of 150?",correct:!0}]).map(x=>({...x,correct:d?!0:x.correct}));return e.jsx("div",{className:"min-h-screen bg-gradient-to-b from-[#F8F7FF] via-white to-white",children:e.jsxs("div",{className:"px-6 pt-12 pb-10",children:[e.jsxs("div",{className:"flex flex-col items-center mb-8",children:[p.showEri&&e.jsx(W,{isPerfect:d,reduceMotion:p.reduceMotion}),e.jsx(a.h1,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},transition:{delay:.4},className:"text-2xl font-bold text-gray-900 mt-6 text-center",children:d?c?"English Mission Perfect!":"Mission Perfect!":"Mission Complete!"}),e.jsx(a.p,{initial:{opacity:0,y:8},animate:{opacity:1,y:0},transition:{delay:.5},className:"text-gray-500 text-sm mt-1 text-center",children:d?c?"Excellent English practice — Eri is proud of you!":"Eri is so proud of you!":c?"Nice progress on write, speak, and listening!":"Great effort — keep going!"})]}),e.jsxs(a.div,{initial:{opacity:0,y:24},animate:{opacity:1,y:0},transition:{delay:.55},className:"bg-white rounded-2xl border border-gray-200/80 p-5 shadow-sm mb-4",children:[e.jsx("p",{className:"text-xs text-[#6C5CE7] font-semibold uppercase tracking-wide mb-3",children:"Mission Summary"}),e.jsx("p",{className:"text-gray-900 font-bold mb-5",children:N}),e.jsx(X,{score:o,total:l}),e.jsx("div",{className:"h-px bg-gray-100 my-4"}),e.jsx("div",{children:C.map((x,u)=>e.jsx(D,{index:u,question:x.question,correct:x.correct,delay:1.1+u*.12},u))})]}),e.jsxs(a.div,{initial:{opacity:0,y:24},animate:{opacity:1,y:0},transition:{delay:.7},className:"bg-gradient-to-br from-[#6C5CE7]/5 to-[#8B7FE8]/10 rounded-2xl border border-[#6C5CE7]/15 p-5 mb-8",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-lg bg-[#6C5CE7] flex items-center justify-center",children:e.jsx(P,{size:16,className:"text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-bold text-gray-900",children:"XP Earned"}),e.jsx(a.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.9},className:"text-xs text-gray-500",children:d?"Perfect bonus included":`${m} XP for completing`})]}),e.jsx(a.div,{initial:{scale:0,rotate:-20},animate:{scale:1,rotate:0},transition:{type:"spring",damping:10,delay:.85},className:"ml-auto",children:e.jsxs("span",{className:"text-xl font-bold text-[#6C5CE7]",children:["+",m]})})]}),e.jsx(z,{xpEarned:m,currentXP:j,levelXP:b})]}),e.jsxs(a.div,{initial:{opacity:0,y:16},animate:{opacity:1,y:0},transition:{delay:.9},className:"space-y-3",children:[e.jsx(g,{onClick:()=>{s("home")},size:"lg",fullWidth:!0,icon:e.jsx(w,{size:18}),children:"Back to Home"}),!d&&e.jsx(g,{onClick:()=>s("review"),variant:"secondary",size:"lg",fullWidth:!0,icon:e.jsx(T,{size:18}),children:"Review Mistakes"}),d&&e.jsx(g,{onClick:()=>s("progress"),variant:"secondary",size:"lg",fullWidth:!0,children:"View Progress"})]})]})})}export{V as SessionResults};
